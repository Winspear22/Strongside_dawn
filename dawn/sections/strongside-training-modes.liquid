{% schema %}
{
  "name": "Strongside Training Modes",
  "settings": [
    {
      "type": "text",
      "id": "section_subtitle",
      "label": "Section Subtitle",
      "default": "Un Outil, Infinies Possibilités"
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Utilise STRONGSIDE Partout"
    }
  ],
  "blocks": [
    {
      "type": "training_mode",
      "name": "Training Mode",
      "settings": [
        {
          "type": "text",
          "id": "number",
          "label": "Number",
          "default": "01"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "SAC DE FRAPPE"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Déchaîne ta puissance sur le sac avec le STRONGSIDE Boxing Harness Pro."
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image (Fallback)"
        },
        {
          "type": "text",
          "id": "video_filename",
          "label": "Video Filename (in assets)",
          "info": "e.g. 'Sac-de-frappe.mp4'. If set, overrides image."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Strongside Training Modes",
      "blocks": [
        {
          "type": "training_mode",
          "settings": {
            "number": "01",
            "title": "SAC DE FRAPPE",
            "description": "Déchaîne ta puissance sur le sac avec le STRONGSIDE Boxing Harness Pro. La résistance progressive transforme chaque frappe en coup dévastateur.",
            "video_filename": "1.mp4"
          }
        },
        {
          "type": "training_mode",
          "settings": {
            "number": "02",
            "title": "PATTES D'OURS",
            "description": "Entraîne-toi avec un partenaire et ses pattes d'ours plus efficacement grâce au STRONGSIDE Boxing Harness Pro. Combine avec les Extra Performance 34kg resistance bands pour une explosivité maximale.",
            "video_filename": "2.mp4"
          }
        },
        {
          "type": "training_mode",
          "settings": {
            "number": "03",
            "title": "SHADOW BOXING",
            "description": "Perfectionne ta technique n'importe où avec le STRONGSIDE Boxing Harness Pro. Ajoute les Extra Performance 34kg resistance bands pour un conditionnement intense lors du Shadow boxing.",
            "video_filename": "3.mp4"
          }
        }
      ]
    }
  ]
}
{% endschema %}

<div class="strongside-training-section">
  <div class="strongside-container">
    <!-- Header -->
    <div class="strongside-training-header ss-observe ss-fade-up">
      <span class="strongside-subtitle">{{ 'strongside.training.subtitle' | t }}</span>
      <h2 class="strongside-title">
        {{ 'strongside.training.titleStart' | t }}
        {{ 'strongside.training.titleEnd' | t }}
      </h2>
    </div>

    <!-- Modes Loop (Static 3 Items) -->
    <div class="strongside-modes-list">
      {% for i in (1..3) %}
        {% assign is_even = forloop.index | modulo: 2 %}
        {% if is_even == 0 %}
          {% assign row_class = 'is-reversed' %}
          {% assign media_anim = 'ss-slide-in-right' %}
          {% assign text_anim = 'ss-slide-in-left' %}
        {% else %}
          {% assign row_class = 'is-normal' %}
          {% assign media_anim = 'ss-slide-in-left' %}
          {% assign text_anim = 'ss-slide-in-right' %}
        {% endif %}

        {% assign trans_key_title = 'strongside.training.modes.' | append: i | append: '_title' %}
        {% assign trans_key_desc = 'strongside.training.modes.' | append: i | append: '_desc' %}

        <div class="strongside-mode-row {{ row_class }}">
          <!-- Media Column -->
          <div class="strongside-mode-media ss-observe {{ media_anim }}" style="transition-delay: 200ms;">
            <div class="media-container">
              <video autoplay loop muted playsinline class="media-content">
                <source src="{{ i | append: '.mp4' | asset_url }}" type="video/mp4">
              </video>
              <div class="media-overlay"></div>
            </div>
          </div>

          <!-- Text Column -->
          <div class="strongside-mode-text ss-observe {{ text_anim }}" style="transition-delay: 300ms;">
            <span class="mode-number">0{{ i }}.</span>
            <h3 class="mode-title">{{ trans_key_title | t }}</h3>
            <p class="mode-desc">{{ trans_key_desc | t }}</p>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
          }
        });
      },
      { threshold: 0.15 }
    ); // Trigger when 15% visible

    document.querySelectorAll('.ss-observe').forEach((el) => observer.observe(el));
  });
</script>

<style>
  /* Scoped styles with high specificity to potential Dawn overrides */
  #shopify-section-{{ section.id }} .strongside-training-section {
    padding: 5rem 1.5rem;
    background-color: #050505 !important; /* Force Black Background */
    color: white !important;
    overflow-x: hidden; /* Prevent horizontal scroll from animations */
    font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue',
      Arial, sans-serif !important;
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .strongside-training-section {
      padding: 8rem 1.5rem;
    }
  }

  /* Renamed container to avoid Dawn conflict and force width */
  #shopify-section-{{ section.id }} .strongside-container {
    max-width: 1400px !important; /* Increased from 1280px (80rem) */
    width: 100% !important;
    margin: 0 auto !important;
  }

  /* Header */
  #shopify-section-{{ section.id }} .strongside-training-header {
    text-align: center;
    margin-bottom: 4rem;
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .strongside-training-header {
      margin-bottom: 8rem !important;
    } /* Increased vertical space */
  }

  #shopify-section-{{ section.id }} .strongside-subtitle {
    color: #ff2222 !important; /* Force Brand Accent */
    font-size: 1.25rem !important; /* Reduced by 30% (approx) */
    font-weight: 900 !important; /* Bold */
    line-height: 1.6rem !important; /* Adjusted */
    text-transform: uppercase !important;
    letter-spacing: 0.1em !important;
    display: block;
    margin-bottom: 0.5rem;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  #shopify-section-{{ section.id }} .strongside-title {
    font-family: 'Inter', system-ui, sans-serif !important; /* Match Hero Title */
    font-size: 3rem !important; /* HUGE: 48px */
    font-weight: 900 !important;
    font-style: italic !important;
    text-transform: uppercase !important;
    letter-spacing: -0.05em !important;
    color: white !important;
    margin: 0;
    line-height: 0.9 !important;
    text-shadow: 0 0 1px rgba(255, 255, 255, 0.4) !important;
    /* border: 1px solid red !important; DEBUG - A supprimer si visible */
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .strongside-title {
      font-size: 5rem !important; /* HUGE: 80px */
    }
  }

  /* Modes List */
  #shopify-section-{{ section.id }} .strongside-modes-list {
    display: flex;
    flex-direction: column;
    gap: 8rem !important; /* Force large vertical gap */
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .strongside-modes-list {
      gap: 12rem !important;
    } /* Even larger gap on desktop */
  }

  /* Mode Row */
  #shopify-section-{{ section.id }} .strongside-mode-row {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3rem !important;
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .strongside-mode-row {
      flex-direction: row;
      gap: 6rem !important; /* Increased gap between text/image */
      justify-content: space-between !important; /* Push elements apart */
    }
    #shopify-section-{{ section.id }} .strongside-mode-row.is-reversed {
      flex-direction: row-reverse;
    }
  }

  /* Media */
  #shopify-section-{{ section.id }} .strongside-mode-media {
    width: 100%;
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .strongside-mode-media {
      width: 50% !important;
    } /* Stay half width but container is wider */
  }
  #shopify-section-{{ section.id }} .media-container {
    position: relative;
    width: 100%;
    aspect-ratio: 4/3;
    border-radius: 1rem;
    overflow: hidden;
    background-color: #171717 !important;
  }
  #shopify-section-{{ section.id }} .media-content {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  #shopify-section-{{ section.id }} .media-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.4), transparent) !important;
    pointer-events: none;
  }

  /* Text */
  #shopify-section-{{ section.id }} .strongside-mode-text {
    width: 100%;
    text-align: center;
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .strongside-mode-text {
      width: 45% !important; /* Slightly smaller text box to allow gap */
      text-align: left;
    }
    #shopify-section-{{ section.id }} .strongside-mode-row.is-reversed .strongside-mode-text {
      text-align: right;
    }
  }

  #shopify-section-{{ section.id }} .mode-number {
    display: block;
    font-family: 'Inter', system-ui, sans-serif !important; /* Match Hero */
    font-size: 7.5rem !important; /* Doubled from 3.75rem */
    font-weight: 900 !important;
    font-style: italic !important;
    color: #ff2222 !important; /* Force Red */
    opacity: 0.3 !important;
    line-height: 1 !important;
    margin-bottom: -2rem !important; /* Increased negative margin for larger overlap */
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .mode-number {
      font-size: 12rem !important; /* Doubled from 6rem */
      margin-bottom: -4rem !important; /* Increased negative margin */
    }
  }

  #shopify-section-{{ section.id }} .mode-title {
    font-family: 'Inter', system-ui, sans-serif !important; /* Match Hero */
    font-size: 2.25rem !important; /* 75% of 3rem (Main Title) */
    font-weight: 900 !important;
    font-style: italic !important;
    text-transform: uppercase !important;
    letter-spacing: -0.05em !important; /* Match Main Title */
    color: white !important;
    margin: 0;
    line-height: 0.9 !important; /* Match Main Title */
    position: relative;
    z-index: 2; /* Approx overlay z-index */
    text-shadow: 0 0 1px rgba(255, 255, 255, 0.4) !important;
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .mode-title {
      font-size: 3.75rem !important; /* 75% of 5rem (Main Title) */
    }
  }

  #shopify-section-{{ section.id }} .mode-desc {
    color: #9ca3af !important; /* Force Gray */
    font-size: 1.25rem !important; /* Increased from 1rem */
    line-height: 1.6 !important;
    max-width: 32rem; /* Increased max-width slightly to accommodate larger text */
    margin: 1rem auto 0 auto;
  }
  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .mode-desc {
      margin: 1rem 0 0 0;
      font-size: 1.5rem !important; /* Increased from 1.125rem */
    }
    #shopify-section-{{ section.id }} .strongside-mode-row.is-reversed .mode-desc {
      margin-left: auto;
    }
  }

  /* --- ANIMATIONS --- */
  .ss-observe {
    opacity: 0;
    transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1); /* Smooth ease-out */
  }

  /* Fade Up (Header) */
  .ss-fade-up {
    transform: translateY(30px);
  }
  .ss-fade-up.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Slide In Left */
  .ss-slide-in-left {
    transform: translateX(-50px);
  }
  .ss-slide-in-left.is-visible {
    opacity: 1;
    transform: translateX(0);
  }

  /* Slide In Right */
  .ss-slide-in-right {
    transform: translateX(50px);
  }
  .ss-slide-in-right.is-visible {
    opacity: 1;
    transform: translateX(0);
  }
</style>
